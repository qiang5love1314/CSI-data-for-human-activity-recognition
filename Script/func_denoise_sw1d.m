function [sigDEN,wDEC] = func_denoise_sw1d(SIG)
% FUNC_DENOISE_SW1D Saved Denoising Process.
%   SIG: vector of data
%   -------------------
%   sigDEN: vector of denoised data
%   wDEC: stationary wavelet decomposition

%  Auto-generated by Wavelet Toolbox on 05-Dec-2016 18:45:30

% Analysis parameters.
%---------------------
wname = 'db10';
level = 8;

% Denoising parameters.
%----------------------
% meth = 'heursure';
% scal_OR_alfa = one;
sorh = 's';    % Specified soft or hard thresholding
thrSettings =  {...
    [...
    1.000000000000000  61440.000000000000000      4.545914470656395; ...
    ]; ...
    [...
    1.000000000000000  61440.000000000000000      4.390790818679856; ...
    ]; ...
    [...
    1.000000000000000  61440.000000000000000      1.076789725623986; ...
    ]; ...
    [...
    1.000000000000000  61440.000000000000000      0.632382907905652; ...
    ]; ...
    [...
    1.000000000000000  61440.000000000000000      0.471770892918595; ...
    ]; ...
    [...
    1.000000000000000  61440.000000000000000      0.227816149729737; ...
    ]; ...
    [...
    1.000000000000000  61440.000000000000000      0.278771417563262; ...
    ]; ...
    [...
    1.000000000000000  61440.000000000000000      0.122704049499844; ...
    ]; ...
    };

% Decompose using SWT.
%---------------------
wDEC = swt(SIG,level,wname);

% Denoise.
%---------
len = length(SIG);
for k = 1:level
    thr_par = thrSettings{k};
    if ~isempty(thr_par)
        NB_int = size(thr_par,1);
        x      = [thr_par(:,1) ; thr_par(NB_int,2)];
        x      = round(x);
        x(x<1) = 1;
        x(x>len) = len;
        thr = thr_par(:,3);
        for j = 1:NB_int
            if j==1 , d_beg = 0; else d_beg = 1; end
            j_beg = x(j)+d_beg;
            j_end = x(j+1);
            j_ind = (j_beg:j_end);
            wDEC(k,j_ind) = wthresh(wDEC(k,j_ind),sorh,thr(j));
        end
    end
end

% Reconstruct the denoise signal using ISWT.
%-------------------------------------------
sigDEN = iswt(wDEC,wname);
